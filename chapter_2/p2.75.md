# Analysis

Suppose that there are two $w$-bit numbers $x$ and $y$, where their unsigned values are denoted $x_u$ and $y_u$, and their two's complement values are denoted $x_t$ and $y_t$. Therefore,

$$
\begin{cases}
x_u = x_{w-1} \cdot 2^{w-1} + x_{Low} \\
y_u = y_{w-1} \cdot 2^{w-1} + y_{Low}
\end{cases}
\qquad
\begin{cases}
x_t = -x_{w-1} \cdot 2^{w-1} + x_{Low} \\
y_t = -y_{w-1} \cdot 2^{w-1} + y_{Low}
\end{cases}
$$

then

$$
\begin{cases}
x_u \cdot y_u = x_{w-1} y_{w-1} 2^{2w-2} + (x_{w-1} y_{Low} + y_{w-1} x_{Low}) 2^{w-1} + x_{Low} y_{Low} \\
x_t \cdot y_t = x_{w-1} y_{w-1} 2^{2w-2} - (x_{w-1} y_{Low} + y_{w-1} x_{Low}) 2^{w-1} + x_{Low} y_{Low}
\end{cases}
$$

So, it is obvious that

$$
x_u \cdot y_u = x_t \cdot y_t + (x_{w-1} y_{Low} + y_{w-1} x_{Low}) 2^{w}
$$

Thus, the higher $w$ bits of this product follow this equivalence:

$$
x_u \cdot y_u \bmod 2^w = x_t \cdot y_t \bmod 2^w + (x_{w-1} y_{Low} + y_{w-1} x_{Low})
$$

# Representation in C Language

To represent the findings above in C language, where $w = 32$, we have:

```c
unsigned unsigned_high_prod(unsigned x, unsigned y)
{
    unsigned maskx = (x >> 31) - 1;
    unsigned xlow = x & 0x7FFFFFFF;
    unsigned masky = (y >> 31) - 1;
    unsigned ylow = y & 0x7FFFFFFF;
    unsigned prod = (unsigned)signed_high_prod((int)x, (int)y);
    prod += (~maskx & ylow) + (~masky & xlow);
    return prod;
}
```
