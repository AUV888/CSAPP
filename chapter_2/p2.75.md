# Analysis

Suppose that there are two $w$ bits number $x$ and $y$ , where their unsigned value are denoted $x_u$ and $y_u$ , their two's complement value are denoted $x_t$ and $y_t$. Therefore,

$$
\left\{
\begin{aligned}
&x_u =x_{w-1} \cdot 2^{w-1} + x_{Low} \\
&y_u=y_{w-1} \cdot 2^{w-1} + y_{Low}
\end{aligned}
\right.
\quad
\left\{
\begin{aligned}
&x_t=-x_{w-1} \cdot 2^{w-1} + x_{Low} \\
&y_t=y_{w-1} \cdot 2^{w-1} + y_{Low}
\end{aligned}
\right.
$$

then

$$
\left\{
\begin{aligned}
&x_u \cdot y_u = x_{w-1}\cdot y_{w-1}\cdot 2^{2w-2}+(x_{w-1}\cdot y_{Low}+y_{w-1}\cdot x_{Low})\cdot 2^{w-1}+x_{Low}\cdot y_{Low} \\
&x_t \cdot y_t = x_{w-1}\cdot y_{w-1}\cdot 2^{2w-2}-(x_{w-1}\cdot y_{Low}+y_{w-1}\cdot x_{Low})\cdot 2^{w-1}+x_{Low}\cdot y_{Low}
\end{aligned}
\right.
$$

So, it is obvious that $x_u \cdot y_u = x_t \cdot y_t + (x_{w-1}\cdot y_{Low}+y_{w-1}\cdot x_{Low})\cdot 2^{w}$. Thus, the higher w bits of this product follows this equivalence:

$$
x_u \cdot y_u \mod 2^w = x_t \cdot y_t \mod 2^w + (x_{w-1}\cdot y_{Low}+y_{w-1}\cdot x_{Low})
$$

# Representation in C Language

To represent the findings above in C language, where $w$=32, we have:

```c
unsigned unsigned_high_prod(unsigned x, unsigned y)
{
    unsigned maskx = (x >> 31) -1;
    unsigned xlow = x & 0x7FFFFFFF;
    unsigned masky = (y >> 31) -1;
    unsigned ylow = y & 0x7FFFFFFF;
    unsigned prod = (unsigned)signed_high_prod((int)x, (int)y);
    prod += (~maskx & ylow) + (~masky & xlow);
    return prod;
}
```
